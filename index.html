<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ãƒ‘ãƒãƒ³ã‚³</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
 <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRAGLrjEeqNmwwVpY-esZAxZMNgZK23-DPXt7zK1romRg&s=10" sizes="16Ã—16" type="image/png" />  
<style>
body{margin:0;background:#020617;color:#fff;font-family:sans-serif;text-align:center;}
header{padding:10px;background:#020617;font-size:18px;font-weight:bold;}
#game{position:relative;margin:0 auto;max-width:420px;height:640px;background:#020617;overflow:hidden;border:3px solid #38bdf8;border-radius:12px;}
canvas{display:block;}
#ui{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;padding:8px;background:#020617;}
button,input[type=range]{padding:8px;font-size:14px;border:none;border-radius:8px;}
button{background:#38bdf8;color:#000;font-weight:bold;}
#status{width:100%;font-size:14px;margin-bottom:4px;}
#lever{position:absolute;right:10px;bottom:60px;width:40px;height:160px;background:#334155;border-radius:20px;}
#leverKnob{position:absolute;left:50%;transform:translateX(-50%);width:50px;height:50px;background:#facc15;border-radius:50%;top:0;touch-action:none;}
#bigWin{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.85);flex-direction:column;z-index:5;}
#bigWin span{font-size:42px;color:#facc15;font-weight:bold;animation:zoom 1s infinite alternate;}
@keyframes zoom{from{transform:scale(1);}to{transform:scale(1.25);}}
#rain{position:absolute;inset:0;pointer-events:none;z-index:6;}
   footer {
           padding: 30px;
           text-align: center;
           font-size: 0.85rem;
           color: rgba(255,255,255,0.5);
           border-top: 1px solid rgba(255,255,255,0.1);
           margin-top: 60px;
   }
</style>
</head>
<body>
<header>ãƒ‘ãƒãƒ³ã‚³</header>
<div id="game">
  <canvas id="c" width="420" height="640"></canvas>
  <div id="lever"><div id="leverKnob"></div></div>
  <div id="bigWin"><span>ğŸ‰ å¤§å½“ãŸã‚Šï¼ ğŸ‰</span></div>
  <canvas id="rain" width="420" height="640"></canvas>
</div>
<div id="ui">
  <div id="status">ç‰:<span id="balls">100</span>ï½œé‡˜å¼·åº¦:<span id="pinPow">1.0</span></div>
  <button id="shot">ç™ºå°„</button>
  <button id="save">ã‚»ãƒ¼ãƒ–</button>
  <button id="load">ãƒ­ãƒ¼ãƒ‰</button>
  <button id="del">å‰Šé™¤</button>
  é‡˜èª¿æ•´<input id="pinRange" type="range" min="0.5" max="2" step="0.1" value="1">
</div>
    <footer>
       Â© 2025 GAMEHUB - All Rights Reserved.
   </footer>

<script>
// ===== Canvas =====
const c = document.getElementById('c');
const ctx = c.getContext('2d');
const rain = document.getElementById('rain');
const rctx = rain.getContext('2d');

// ===== UI =====
const ballsEl = document.getElementById('balls');
const pinPowEl = document.getElementById('pinPow');
const bigWinEl = document.getElementById('bigWin');

// ===== Game State =====
let balls = 100;
let ballList = [];
let pins = [];
let gravity = 0.22;
let pinPower = 1.0;

// â˜… å°ã•ãã¦å‹•ããƒ»å‡ºç¾ã™ã‚‹ ç¢ºå®šå¤§å½“ãŸã‚Šã‚¾ãƒ¼ãƒ³
let jackpotZone = { x: 200, y: 520, w: 30, h: 22 };
let zoneVX = 1.6;
let zoneVY = 0.8;
let zoneVisible = true;
let zoneTimer = 0;

// ===== Init =====
function initPins(){
  pins = [];
  for(let y=120;y<480;y+=60){
    for(let x=80;x<340;x+=60){
      pins.push({x:x+(y%120?30:0), y});
    }
  }
}
initPins();

function updateStatus(){ ballsEl.textContent = balls; }

// ===== Shooting =====
function shoot(strength=1){
  if(balls<=0) return;
  balls--;
  updateStatus();
  ballList.push({
    x:210,
    y:40,
    vx:(Math.random()-0.5)*2*strength,
    vy:2*strength
  });
}

document.getElementById('shot').onclick = () => shoot(1);

// ===== Virtual Lever =====
const knob = document.getElementById('leverKnob');
let dragging=false, startY=0;
knob.addEventListener('pointerdown',e=>{ dragging=true; startY=e.clientY; });
window.addEventListener('pointerup',()=>{
  if(!dragging) return;
  const pull = Math.min(1, Math.max(0, knob.offsetTop/100));
  shoot(0.6 + pull*2);
  knob.style.top='0px';
  dragging=false;
});
window.addEventListener('pointermove',e=>{
  if(!dragging) return;
  const dy = e.clientY - startY;
  knob.style.top = Math.min(100, Math.max(0, dy)) + 'px';
});

// ===== Pin Control =====
const pinRange = document.getElementById('pinRange');
pinRange.oninput = () => {
  pinPower = parseFloat(pinRange.value);
  pinPowEl.textContent = pinPower.toFixed(1);
};

// ===== Save / Load =====
function save(){ localStorage.setItem('pachinkoSave', JSON.stringify({balls,pinPower})); }
function load(){
  const d = JSON.parse(localStorage.getItem('pachinkoSave')||'null');
  if(!d) return;
  balls=d.balls; pinPower=d.pinPower;
  pinRange.value=pinPower; pinPowEl.textContent=pinPower.toFixed(1);
  updateStatus();
}
function del(){ localStorage.removeItem('pachinkoSave'); }

document.getElementById('save').onclick=save;
document.getElementById('load').onclick=load;
document.getElementById('del').onclick=del;

// ===== Big Win =====
function bigWin(){
  bigWinEl.style.display='flex';
  balls += 50;
  updateStatus();
  startRain();
  setTimeout(()=>bigWinEl.style.display='none',2500);
}

function startRain(){
  let drops=[];
  for(let i=0;i<90;i++) drops.push({x:Math.random()*420,y:Math.random()*-640,v:2+Math.random()*4});
  let t=0;
  (function anim(){
    rctx.clearRect(0,0,420,640);
    rctx.fillStyle='#facc15';
    drops.forEach(d=>{ d.y+=d.v; rctx.fillRect(d.x,d.y,4,10); });
    t++;
    if(t<140) requestAnimationFrame(anim);
    else rctx.clearRect(0,0,420,640);
  })();
}

// ===== Main Loop =====
function update(){
  // Zone movement & visibility
  zoneTimer++;
  if(zoneTimer%180===0) zoneVisible=!zoneVisible;
  if(zoneVisible){
    jackpotZone.x+=zoneVX;
    jackpotZone.y+=zoneVY;
    if(jackpotZone.x<70||jackpotZone.x+jackpotZone.w>350) zoneVX*=-1;
    if(jackpotZone.y<470||jackpotZone.y+jackpotZone.h>560) zoneVY*=-1;
  }

  ctx.clearRect(0,0,420,640);

  // Pins
  ctx.fillStyle='#94a3b8';
  pins.forEach(p=>{ ctx.beginPath(); ctx.arc(p.x,p.y,5,0,Math.PI*2); ctx.fill(); });

  // Jackpot Zone
  if(zoneVisible){
    ctx.fillStyle='rgba(250,204,21,0.45)';
    ctx.fillRect(jackpotZone.x,jackpotZone.y,jackpotZone.w,jackpotZone.h);
    ctx.strokeStyle='#facc15'; ctx.lineWidth=3;
    ctx.strokeRect(jackpotZone.x,jackpotZone.y,jackpotZone.w,jackpotZone.h);
    ctx.lineWidth=1;
  }

  // Balls
  ctx.fillStyle='#e5e7eb';
  ballList.forEach(b=>{
    b.vy+=gravity; b.x+=b.vx; b.y+=b.vy;
    pins.forEach(p=>{
      const dx=b.x-p.x, dy=b.y-p.y;
      const d=Math.hypot(dx,dy);
      if(d<8){ b.vx+=(dx/d)*0.4*pinPower; b.vy+=(dy/d)*0.4*pinPower; }
    });
    if(b.x<5||b.x>415) b.vx*=-1;

    if(zoneVisible && b.x>jackpotZone.x && b.x<jackpotZone.x+jackpotZone.w && b.y>jackpotZone.y && b.y<jackpotZone.y+jackpotZone.h){
      bigWin(); b.y=700;
    }

    ctx.beginPath(); ctx.arc(b.x,b.y,4,0,Math.PI*2); ctx.fill();
  });

  ballList = ballList.filter(b=>b.y<660);
  requestAnimationFrame(update);
}
update();
</script>
</body>
</html>
